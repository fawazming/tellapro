!function(t,e){"object"==typeof exports&&exports&&"string"!=typeof exports.nodeName?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):(t.Mustache={},e(t.Mustache))}(this,(function(t){var e=Object.prototype.toString,r=Array.isArray||function(t){return"[object Array]"===e.call(t)};function n(t){return"function"==typeof t}function a(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function i(t,e){return null!=t&&"object"==typeof t&&e in t}var s=RegExp.prototype.test;var o=/\S/;function c(t){return!function(t,e){return s.call(t,e)}(o,t)}var u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};var l=/\s*/,h=/\s+/,p=/\s*=/,f=/\s*\}/,d=/#|\^|\/|>|\{|&|=|!/;function g(t){this.string=t,this.tail=t,this.pos=0}function w(t,e){this.view=t,this.cache={".":this.view},this.parent=e}function v(){this.cache={}}g.prototype.eos=function(){return""===this.tail},g.prototype.scan=function(t){var e=this.tail.match(t);if(!e||0!==e.index)return"";var r=e[0];return this.tail=this.tail.substring(r.length),this.pos+=r.length,r},g.prototype.scanUntil=function(t){var e,r=this.tail.search(t);switch(r){case-1:e=this.tail,this.tail="";break;case 0:e="";break;default:e=this.tail.substring(0,r),this.tail=this.tail.substring(r)}return this.pos+=e.length,e},w.prototype.push=function(t){return new w(t,this)},w.prototype.lookup=function(t){var e,r,a,s=this.cache;if(s.hasOwnProperty(t))e=s[t];else{for(var o,c,u,l=this,h=!1;l;){if(t.indexOf(".")>0)for(o=l.view,c=t.split("."),u=0;null!=o&&u<c.length;)u===c.length-1&&(h=i(o,c[u])||(r=o,a=c[u],null!=r&&"object"!=typeof r&&r.hasOwnProperty&&r.hasOwnProperty(a))),o=o[c[u++]];else o=l.view[t],h=i(l.view,t);if(h){e=o;break}l=l.parent}s[t]=e}return n(e)&&(e=e.call(this.view)),e},v.prototype.clearCache=function(){this.cache={}},v.prototype.parse=function(e,n){var i=this.cache,s=e+":"+(n||t.tags).join(":"),o=i[s];return null==o&&(o=i[s]=function(e,n){if(!e)return[];var i,s,o,u=!1,w=[],v=[],y=[],m=!1,k=!1,b="",x=0;function E(){if(m&&!k)for(;y.length;)delete v[y.pop()];else y=[];m=!1,k=!1}function T(t){if("string"==typeof t&&(t=t.split(h,2)),!r(t)||2!==t.length)throw new Error("Invalid tags: "+t);i=new RegExp(a(t[0])+"\\s*"),s=new RegExp("\\s*"+a(t[1])),o=new RegExp("\\s*"+a("}"+t[1]))}T(n||t.tags);for(var D,U,I,j,P,S,V=new g(e);!V.eos();){if(D=V.pos,I=V.scanUntil(i))for(var C=0,A=I.length;C<A;++C)c(j=I.charAt(C))?(y.push(v.length),b+=j):(k=!0,u=!0,b+=" "),v.push(["text",j,D,D+1]),D+=1,"\n"===j&&(E(),b="",x=0,u=!1);if(!V.scan(i))break;if(m=!0,U=V.scan(d)||"name",V.scan(l),"="===U?(I=V.scanUntil(p),V.scan(p),V.scanUntil(s)):"{"===U?(I=V.scanUntil(o),V.scan(f),V.scanUntil(s),U="&"):I=V.scanUntil(s),!V.scan(s))throw new Error("Unclosed tag at "+V.pos);if(P=">"==U?[U,I,D,V.pos,b,x,u]:[U,I,D,V.pos],x++,v.push(P),"#"===U||"^"===U)w.push(P);else if("/"===U){if(!(S=w.pop()))throw new Error('Unopened section "'+I+'" at '+D);if(S[1]!==I)throw new Error('Unclosed section "'+S[1]+'" at '+D)}else"name"===U||"{"===U||"&"===U?k=!0:"="===U&&T(I)}if(E(),S=w.pop())throw new Error('Unclosed section "'+S[1]+'" at '+V.pos);return function(t){for(var e,r=[],n=r,a=[],i=0,s=t.length;i<s;++i)switch((e=t[i])[0]){case"#":case"^":n.push(e),a.push(e),n=e[4]=[];break;case"/":a.pop()[5]=e[2],n=a.length>0?a[a.length-1][4]:r;break;default:n.push(e)}return r}(function(t){for(var e,r,n=[],a=0,i=t.length;a<i;++a)(e=t[a])&&("text"===e[0]&&r&&"text"===r[0]?(r[1]+=e[1],r[3]=e[3]):(n.push(e),r=e));return n}(v))}(e,n)),o},v.prototype.render=function(t,e,r,n){var a=this.parse(t,n),i=e instanceof w?e:new w(e);return this.renderTokens(a,i,r,t,n)},v.prototype.renderTokens=function(t,e,r,n,a){for(var i,s,o,c="",u=0,l=t.length;u<l;++u)o=void 0,"#"===(s=(i=t[u])[0])?o=this.renderSection(i,e,r,n):"^"===s?o=this.renderInverted(i,e,r,n):">"===s?o=this.renderPartial(i,e,r,a):"&"===s?o=this.unescapedValue(i,e):"name"===s?o=this.escapedValue(i,e):"text"===s&&(o=this.rawValue(i)),void 0!==o&&(c+=o);return c},v.prototype.renderSection=function(t,e,a,i){var s=this,o="",c=e.lookup(t[1]);if(c){if(r(c))for(var u=0,l=c.length;u<l;++u)o+=this.renderTokens(t[4],e.push(c[u]),a,i);else if("object"==typeof c||"string"==typeof c||"number"==typeof c)o+=this.renderTokens(t[4],e.push(c),a,i);else if(n(c)){if("string"!=typeof i)throw new Error("Cannot use higher-order sections without the original template");null!=(c=c.call(e.view,i.slice(t[3],t[5]),(function(t){return s.render(t,e,a)})))&&(o+=c)}else o+=this.renderTokens(t[4],e,a,i);return o}},v.prototype.renderInverted=function(t,e,n,a){var i=e.lookup(t[1]);if(!i||r(i)&&0===i.length)return this.renderTokens(t[4],e,n,a)},v.prototype.indentPartial=function(t,e,r){for(var n=e.replace(/[^ \t]/g,""),a=t.split("\n"),i=0;i<a.length;i++)a[i].length&&(i>0||!r)&&(a[i]=n+a[i]);return a.join("\n")},v.prototype.renderPartial=function(t,e,r,a){if(r){var i=n(r)?r(t[1]):r[t[1]];if(null!=i){var s=t[6],o=t[5],c=t[4],u=i;return 0==o&&c&&(u=this.indentPartial(i,c,s)),this.renderTokens(this.parse(u,a),e,r,u)}}},v.prototype.unescapedValue=function(t,e){var r=e.lookup(t[1]);if(null!=r)return r},v.prototype.escapedValue=function(e,r){var n=r.lookup(e[1]);if(null!=n)return t.escape(n)},v.prototype.rawValue=function(t){return t[1]},t.name="mustache.js",t.version="3.1.0",t.tags=["{{","}}"];var y=new v;return t.clearCache=function(){return y.clearCache()},t.parse=function(t,e){return y.parse(t,e)},t.render=function(t,e,n,a){if("string"!=typeof t)throw new TypeError('Invalid template! Template should be a "string" but "'+((r(i=t)?"array":typeof i)+'" was given as the first argument for mustache#render(template, view, partials)'));var i;return y.render(t,e,n,a)},t.to_html=function(e,r,a,i){var s=t.render(e,r,a);if(!n(i))return s;i(s)},t.escape=function(t){return String(t).replace(/[&<>"'`=\/]/g,(function(t){return u[t]}))},t.Scanner=g,t.Context=w,t.Writer=v,t}));class TemplatingEngine{constructor(t){if(!t.templateId||!t.outputId)throw new Error("templateId and outputId are required");this.template=document.getElementById(t.templateId).innerHTML,this.output=document.getElementById(t.outputId),this.dataUrl=t.dataUrl,this.fallbackData=t.fallbackData||null,this.cache=null,this.cacheDuration=t.cacheDuration||0}async render(){try{const t=this.cache&&this.isCacheValid()?this.cache.data:await this.fetchData();this.cacheDuration>0&&(this.cache={data:t,timestamp:Date.now()}),this.output.innerHTML=this.compile(t)}catch(t){this.fallbackData?this.output.innerHTML=this.compile(this.fallbackData):this.output.innerHTML='<div class="template-error">Failed to load content</div>'}}async fetchData(){if(!this.dataUrl){if(this.fallbackData)return this.fallbackData;throw new Error("No data source provided")}const t=await fetch(this.dataUrl);if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);return await t.json()}compile(t){try{let e=this.template.replace(/{{\s*(\w+)\s*}}/g,((e,r)=>void 0!==t[r]?t[r]:e));return e=e.replace(/{{\s*#(\w+)\s*}}([\s\S]*?){{\s*\/\1\s*}}/g,((e,r,n)=>{const a=t[r];return a&&Array.isArray(a)?a.map((t=>n.replace(/{{\s*\.\s*}}/g,t))).join(""):""})),e}catch(t){return'<div class="template-error">Template error</div>'}}isCacheValid(){return Date.now()-this.cache.timestamp<this.cacheDuration}static init(t){const e=new TemplatingEngine(t);return e.render(),e}}